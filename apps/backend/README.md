# MHW2Wiki Backend

åŸºäº NestJS + GraphQL + Prisma æ„å»ºçš„ã€Šæ€ªç‰©çŒäººã€‹èµ„æ–™åº“åç«¯æœåŠ¡ã€‚

## é¡¹ç›®ç»“æ„

```
apps/backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ modules/           # ä¸šåŠ¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ monster/      # æ€ªç‰©æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ item/         # ç‰©å“æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ armor/        # é˜²å…·æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ weapon/       # æ­¦å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ skill/        # æŠ€èƒ½æ¨¡å—
â”‚   â”‚   â””â”€â”€ common/       # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ graphql/          # GraphQL é…ç½®
â”‚   â”œâ”€â”€ database/         # æ•°æ®åº“è¿æ¥
â”‚   â””â”€â”€ main.ts           # åº”ç”¨å…¥å£
â”œâ”€â”€ prisma/               # Prisma é…ç½®ï¼ˆè½¯é“¾æ¥åˆ° packages/databaseï¼‰
â””â”€â”€ test/                 # æµ‹è¯•æ–‡ä»¶
```

## æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: NestJS 10.x
- **API**: GraphQL (Code-First) 
- **ORM**: Prisma 5.x
- **æ•°æ®åº“**: PostgreSQL 15+
- **è¯­è¨€**: TypeScript 5.x
- **æµ‹è¯•**: Jest + Supertest
- **éªŒè¯**: class-validator + class-transformer
- **ç¼“å­˜**: Redis (å¯é€‰)

## å¼€å‘è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„ ğŸš§
- [ ] åˆå§‹åŒ– NestJS é¡¹ç›®
- [ ] é…ç½® GraphQL (Code-First)
- [ ] é›†æˆ Prisma ORM
- [ ] è®¾ç½®ç¯å¢ƒé…ç½®å’ŒéªŒè¯
- [ ] é…ç½® CORS å’Œå®‰å…¨ä¸­é—´ä»¶

### Phase 2: æ ¸å¿ƒæ¨¡å— ğŸ“‹
- [ ] Monster æ¨¡å— (æ€ªç‰©æŸ¥è¯¢ã€ç­›é€‰ã€ç”Ÿæ€åˆ†ç±»)
- [ ] Item æ¨¡å— (ç‰©å“ä¿¡æ¯ã€åˆ†ç±»ã€ææ–™å…³ç³»)
- [ ] Armor æ¨¡å— (é˜²å…·æ•°æ®ã€æŠ€èƒ½å…³è”ã€å‡çº§è·¯çº¿)
- [ ] Weapon æ¨¡å— (æ­¦å™¨ç³»åˆ—ã€å‡çº§è·¯çº¿ã€ç±»å‹åˆ†ç±»)
- [ ] Skill æ¨¡å— (æŠ€èƒ½æ•ˆæœã€ç­‰çº§ç³»ç»Ÿ)
- [ ] Decoration æ¨¡å— (è£…é¥°å“ã€æŠ¤çŸ³ã€é­…åŠ›é¥°å“)
- [ ] Stage æ¨¡å— (åœ°å›¾ä¿¡æ¯ã€åŒºåŸŸæ•°æ®ã€è¥åœ°ä½ç½®)
- [ ] Species æ¨¡å— (æ€ªç‰©åˆ†ç±»ã€ç”Ÿæ€ç‰¹å¾)

### Phase 3: ä¸“ä¸šå·¥å…·API âš¡
- [ ] HuntingHorn æ¨¡å— (éŸ³ç¬¦ç³»ç»Ÿã€æ—‹å¾‹é…ç½®ã€æ­Œæ›²æ•ˆæœ)
- [ ] Builder æ¨¡å— (é…è£…è®¡ç®—ã€æŠ€èƒ½ä¼˜åŒ–ã€å¥—è£…æ¨è)
- [ ] Calculator æ¨¡å— (å‡çº§è´¹ç”¨ã€ææ–™éœ€æ±‚ã€è·¯çº¿è§„åˆ’)
- [ ] Search æ¨¡å— (å…¨å±€æœç´¢ã€æ™ºèƒ½ç­›é€‰ã€å…³è”æ¨è)
- [ ] Analytics æ¨¡å— (æ•°æ®ç»Ÿè®¡ã€ä½¿ç”¨åˆ†æã€æ€§èƒ½ç›‘æ§)

### Phase 4: éƒ¨ç½²ä¼˜åŒ– ğŸš€
- [ ] ç”Ÿäº§ç¯å¢ƒé…ç½®
- [ ] PM2 è¿›ç¨‹ç®¡ç†
- [ ] å®å¡”é¢æ¿éƒ¨ç½²è„šæœ¬
- [ ] ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ

## å¼€å‘æŒ‡å—

### å®‰è£…ä¾èµ–
```bash
cd apps/backend
npm install
```

### ç¯å¢ƒé…ç½®
å¤åˆ¶å¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼š
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ç­‰
```

### å¼€å‘æ¨¡å¼
```bash
npm run dev
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```bash
npm run build
npm run start:prod
```

### æµ‹è¯•
```bash
npm run test          # å•å…ƒæµ‹è¯•
npm run test:e2e      # ç«¯åˆ°ç«¯æµ‹è¯•
npm run test:cov      # æµ‹è¯•è¦†ç›–ç‡
```

## API æ–‡æ¡£

å¼€å‘æœåŠ¡å™¨å¯åŠ¨åï¼Œå¯è®¿é—®ï¼š
- GraphQL Playground: `http://localhost:4000/graphql`
- API æ–‡æ¡£: `http://localhost:4000/docs` (å¯é€‰)

## æ€§èƒ½è€ƒè™‘

- ä½¿ç”¨ DataLoader é¿å… N+1 æŸ¥è¯¢é—®é¢˜
- å®ç°æŸ¥è¯¢å¤æ‚åº¦é™åˆ¶
- é…ç½®é€‚å½“çš„æ•°æ®åº“ç´¢å¼•
- ä½¿ç”¨ Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
- å¯ç”¨ GraphQL æŸ¥è¯¢ç¼“å­˜
