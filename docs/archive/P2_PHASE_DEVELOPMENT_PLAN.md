# MHWildsWiki P2é˜¶æ®µå¼€å‘è®¡åˆ’ - æœ€ç»ˆæ‰§è¡Œç‰ˆ

## ğŸ“Š **å½“å‰çŠ¶æ€è¯„ä¼° (2025-01-15)**

### âœ… **P1é˜¶æ®µå·²å®Œæˆ (58.3%â†’75%)**
- **è¯¦æƒ…é¡µé¢ç³»ç»Ÿ**: 100% å®Œæˆ âœ…
- **æ•°æ®å…³è”æ¢å¤**: 75% å®Œæˆ ğŸš§
- **åŸºç¡€UI/UX**: 100% å®Œæˆ âœ…  
- **GraphQLæ¶æ„**: 100% å®Œæˆ âœ…

### ğŸ¯ **P1é˜¶æ®µå‰©ä½™ä»»åŠ¡ (é¢„è®¡3å¤©å†…å®Œæˆ)**
1. **Mockåˆ°Prismaæ•°æ®åˆ‡æ¢**
   - åç«¯EnhancedServicesçš„PrismaæŸ¥è¯¢ä¼˜åŒ–
   - N+1æŸ¥è¯¢é—®é¢˜è§£å†³
   - æ•°æ®åº“è¿æ¥æ± é…ç½®ä¼˜åŒ–

---

## ğŸš€ **P2é˜¶æ®µæ ¸å¿ƒä»»åŠ¡è§„åˆ’**

### ğŸ” **Phase 2A: å…¨å±€æœç´¢ç³»ç»Ÿ (ä¼˜å…ˆçº§ğŸ”´æé«˜)**

#### **æŠ€æœ¯å®ç°è·¯å¾„**
```typescript
// 1. æœç´¢ç´¢å¼•æ„å»º (åç«¯)
interface SearchIndex {
  monsters: { id: string; name: string; description: string; species: string }[];
  weapons: { id: string; name: string; type: string; description?: string }[];
  items: { id: string; name: string; category: string; description: string }[];
}

// 2. ç»Ÿä¸€æœç´¢API (GraphQL)
type Query {
  globalSearch(query: String!, limit: Int = 20): SearchResults!
}

type SearchResults {
  monsters: [Monster!]!
  weapons: [Weapon!]!
  items: [Item!]!
  total: Int!
}
```

#### **å‰ç«¯ç»„ä»¶æ¶æ„**
```
src/components/search/
â”œâ”€â”€ GlobalSearchBar.tsx      # å…¨å±€æœç´¢æ¡†ç»„ä»¶
â”œâ”€â”€ SearchResults.tsx        # æœç´¢ç»“æœé¡µé¢
â”œâ”€â”€ SearchSuggestions.tsx    # æœç´¢å»ºè®®ä¸‹æ‹‰
â””â”€â”€ hooks/
    â”œâ”€â”€ useSearch.ts         # æœç´¢é€»è¾‘Hook
    â””â”€â”€ useSearchHistory.ts  # æœç´¢å†å²Hook
```

#### **å®ç°ç»†èŠ‚**
1. **é˜²æŠ–æœç´¢**: 300mså»¶è¿Ÿï¼Œé¿å…è¿‡é¢‘è¯·æ±‚
2. **æœç´¢ç¼“å­˜**: Apollo Clientç¼“å­˜ + localStorage
3. **æœç´¢å»ºè®®**: åŸºäºè¾“å…¥çš„å®æ—¶å»ºè®®
4. **æœç´¢å†å²**: æœ¬åœ°å­˜å‚¨ç”¨æˆ·æœç´¢è®°å½•

---

### ğŸ“Š **Phase 2B: é«˜çº§ç­›é€‰å¢å¼º (ä¼˜å…ˆçº§ğŸŸ¡ä¸­)**

#### **å½“å‰çŠ¶æ€åˆ†æ**
âœ… **å·²å®ç°çš„ç­›é€‰åŠŸèƒ½**:
- æ€ªç‰©é¡µé¢: ç§ç±»ã€æ –æ¯åœ°ã€å¨èƒç­‰çº§ç­›é€‰
- æ­¦å™¨é¡µé¢: ç±»å‹ã€æ”»å‡»åŠ›ã€ç¨€æœ‰åº¦ç­›é€‰  
- ç‰©å“é¡µé¢: åˆ†ç±»ã€ç¨€æœ‰åº¦ã€ä»·å€¼ç­›é€‰

#### **éœ€è¦å¢å¼ºçš„åŠŸèƒ½**
1. **URLçŠ¶æ€åŒæ­¥**: ç­›é€‰æ¡ä»¶å¯åˆ†äº«å’Œä¹¦ç­¾
2. **ç»„åˆç­›é€‰ä¼˜åŒ–**: å¤šæ¡ä»¶æ€§èƒ½ä¼˜åŒ–
3. **ç­›é€‰å†å²**: å¸¸ç”¨ç­›é€‰æ¡ä»¶å¿«é€Ÿè®¿é—®

```typescript
// URLçŠ¶æ€ç®¡ç†
interface FilterState {
  search?: string;
  category?: string[];
  rarity?: [number, number];
  // ... å…¶ä»–ç­›é€‰æ¡ä»¶
}

// ä½¿ç”¨Next.js useSearchParamsè¿›è¡ŒURLåŒæ­¥
const useFilterState = () => {
  const searchParams = useSearchParams();
  const router = useRouter();
  
  const updateFilters = (newFilters: Partial<FilterState>) => {
    const params = new URLSearchParams(searchParams);
    // æ›´æ–°URLå‚æ•°
    router.push(`?${params.toString()}`);
  };
};
```

---

### âš¡ **Phase 2C: æ€§èƒ½ä¼˜åŒ–ä¸ç”¨æˆ·ä½“éªŒæå‡**

#### **å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥**
```typescript
// next.config.js ä¼˜åŒ–é…ç½®
const nextConfig = {
  images: {
    unoptimized: false, // å¯ç”¨Next.jså›¾ç‰‡ä¼˜åŒ–
    domains: ['example.com'], // å…è®¸çš„å¤–éƒ¨å›¾ç‰‡åŸŸå
    formats: ['image/webp', 'image/avif'], // ç°ä»£å›¾ç‰‡æ ¼å¼
  },
  // é™æ€å¯¼å‡ºæ—¶çš„å›¾ç‰‡å¤„ç†
  trailingSlash: true,
  output: 'export'
};
```

#### **ä»£ç åˆ†å‰²ä¼˜åŒ–**
```typescript
// åŠ¨æ€å¯¼å…¥å¤§å‹ç»„ä»¶
const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <div>åŠ è½½ä¸­...</div>,
  ssr: false // ä»…å®¢æˆ·ç«¯æ¸²æŸ“
});

// è·¯ç”±çº§ä»£ç åˆ†å‰²å·²é€šè¿‡App Routerè‡ªåŠ¨å®ç°
```

#### **æ•°æ®åŠ è½½ä¼˜åŒ–**
```typescript
// é¢„åŠ è½½å…³é”®æ•°æ®
const usePrefetchData = () => {
  const client = useApolloClient();
  
  useEffect(() => {
    // é¢„åŠ è½½æ€ªç‰©åˆ—è¡¨æ•°æ®
    client.prefetchQuery({
      query: GET_MONSTERS,
      variables: { limit: 20 }
    });
  }, []);
};
```

---

## ğŸ“‹ **P2é˜¶æ®µæ‰§è¡Œè®¡åˆ’ä¸æ—¶é—´çº¿**

### **Week 1: æœç´¢ç³»ç»Ÿå®ç°**
- Day 1-2: åç«¯æœç´¢APIå’Œç´¢å¼•æ„å»º
- Day 3-4: å‰ç«¯SearchBarç»„ä»¶å’Œæœç´¢é¡µé¢
- Day 5: æœç´¢æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥

### **Week 2: ç­›é€‰åŠŸèƒ½å¢å¼º**
- Day 1-2: URLçŠ¶æ€åŒæ­¥å®ç°
- Day 3: ç­›é€‰å†å²å’Œå¿«é€Ÿè®¿é—®
- Day 4-5: ç­›é€‰æ€§èƒ½ä¼˜åŒ–å’Œæµ‹è¯•

### **Week 3: æ€§èƒ½ä¼˜åŒ–ä¸äº¤ä»˜**
- Day 1-2: å›¾ç‰‡ä¼˜åŒ–å’Œä»£ç åˆ†å‰²
- Day 3: æ•´ä½“æ€§èƒ½æµ‹è¯•å’Œè°ƒä¼˜
- Day 4-5: æ–‡æ¡£æ›´æ–°å’Œäº¤ä»˜å‡†å¤‡

---

## ğŸ¯ **éªŒæ”¶æ ‡å‡†ä¸æµ‹è¯•æŒ‡æ ‡**

### **åŠŸèƒ½éªŒæ”¶**
- [ ] å…¨å±€æœç´¢è¦†ç›–æ‰€æœ‰æ•°æ®ç±»å‹
- [ ] æœç´¢å“åº”æ—¶é—´ < 200ms
- [ ] ç­›é€‰URLå¯åˆ†äº«å’Œä¹¦ç­¾
- [ ] ç§»åŠ¨ç«¯æœç´¢ä½“éªŒä¼˜åŒ–

### **æ€§èƒ½æŒ‡æ ‡**
```typescript
interface PerformanceTargets {
  lighthouse: {
    performance: 90+,
    accessibility: 95+,
    bestPractices: 90+,
    seo: 95+
  };
  webVitals: {
    LCP: "< 2.5s",     // Largest Contentful Paint
    FID: "< 100ms",    // First Input Delay  
    CLS: "< 0.1"       // Cumulative Layout Shift
  };
}
```

### **ç”¨æˆ·ä½“éªŒéªŒæ”¶**
- [ ] æœç´¢å»ºè®®å“åº”åŠæ—¶
- [ ] ç­›é€‰ç»„åˆæ“ä½œæµç•…
- [ ] æ•°æ®åŠ è½½çŠ¶æ€æ¸…æ™°
- [ ] é”™è¯¯å¤„ç†ç”¨æˆ·å‹å¥½

---

## ğŸ’¡ **å¼€å‘æœ€ä½³å®è·µ**

### **ä»£ç è´¨é‡ä¿è¯**
1. **TypeScriptä¸¥æ ¼æ¨¡å¼**: ç¡®ä¿ç±»å‹å®‰å…¨
2. **ESLint + Prettier**: ä»£ç é£æ ¼ä¸€è‡´æ€§
3. **å•å…ƒæµ‹è¯•**: å…³é”®ç»„ä»¶å’ŒHookæµ‹è¯•
4. **E2Eæµ‹è¯•**: æœç´¢å’Œç­›é€‰æµç¨‹æµ‹è¯•

### **åä½œä¸æ–‡æ¡£**
1. **Gitå·¥ä½œæµ**: Featureåˆ†æ”¯ + PRå®¡æŸ¥
2. **Commitè§„èŒƒ**: Conventional Commits
3. **APIæ–‡æ¡£**: GraphQL Playgroundè‡ªåŠ¨ç”Ÿæˆ
4. **ç»„ä»¶æ–‡æ¡£**: Storybookæˆ–ç®€å•çš„README

### **éƒ¨ç½²ä¸ç›‘æ§**
1. **CI/CDæµç¨‹**: è‡ªåŠ¨åŒ–æ„å»ºå’Œéƒ¨ç½²
2. **æ€§èƒ½ç›‘æ§**: å…³é”®æŒ‡æ ‡å®æ—¶ç›‘æ§
3. **é”™è¯¯è¿½è¸ª**: ç”Ÿäº§ç¯å¢ƒé”™è¯¯æ”¶é›†
4. **ç”¨æˆ·åé¦ˆ**: ä½¿ç”¨æ•°æ®æ”¶é›†å’Œåˆ†æ

---

## ğŸ”„ **æŒç»­è¿­ä»£ç­–ç•¥**

### **P3é˜¶æ®µé¢„è§ˆ (æœªæ¥è§„åˆ’)**
- ç”¨æˆ·è´¦æˆ·ç³»ç»Ÿå’Œä¸ªæ€§åŒ–
- é«˜çº§æ•°æ®åˆ†æå’Œç»Ÿè®¡
- ç¤¾åŒºåŠŸèƒ½å’Œç”¨æˆ·è´¡çŒ®
- ç§»åŠ¨ç«¯PWAä¼˜åŒ–

### **æŠ€æœ¯å€ºåŠ¡ç®¡ç†**
- å®šæœŸé‡æ„å’Œä»£ç æ¸…ç†
- ä¾èµ–åŒ…æ›´æ–°å’Œå®‰å…¨è¡¥ä¸
- æ€§èƒ½ç“¶é¢ˆè¯†åˆ«å’Œä¼˜åŒ–
- ç”¨æˆ·åé¦ˆçš„å¿«é€Ÿå“åº”

**è¿™ä¸ªP2é˜¶æ®µè®¡åˆ’åŸºäºå½“å‰75%çš„P1å®Œæˆåº¦ï¼Œä¸“æ³¨äºå®ç”¨æ€§å’Œå¯æ‰§è¡Œæ€§ï¼Œç¡®ä¿æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰æ˜ç¡®çš„äº¤ä»˜æ ‡å‡†å’Œæ—¶é—´çº¿ã€‚**
